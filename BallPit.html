<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="http://clipart-library.com/img/1764123.png" type="image/png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Ultimate Ball Pit</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            margin: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(to bottom, #87CEEB, #1E90FF);
            font-family: 'Arial Rounded MT Bold', 'Arial', sans-serif;
            height: 100vh;
        }
        
        #ui-container {
            position: absolute;
            top: 20px;
            display: flex;
            gap: 15px;
            z-index: 10;
        }
        
        button {
            padding: 12px 24px;
            font-size: 16px;
            background: linear-gradient(to bottom, #4A6FA5, #2E4A76);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
            background: linear-gradient(to bottom, #5A7FB5, #3E5A86);
        }
        
        button:active {
            transform: translateY(1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        #ball-counter {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.8);
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 18px;
            font-weight: bold;
            color: #2E4A76;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 10;
        }
        
        canvas {
            display: block;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        #title {
            position: absolute;
            top: 20px;
            font-size: 32px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }
        
        .particle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: white;
            border-radius: 50%;
            pointer-events: none;
            opacity: 0.7;
        }
    </style>
</head>
<body>
    <h1 id="title">The Ultimate Ball Pit</h1>
    
    <div id="ui-container">
        <button id="addBalls">Add More Balls</button>
        <button id="clearBalls">Clear Balls</button>
        <button id="changeColors">Change Colors</button>
        <button id="toggleGravity">Normal Gravity</button>
    </div>
    
    <div id="ball-counter">Balls: 50</div>

    <script>
        const { Engine, Render, Runner, World, Bodies, Mouse, MouseConstraint } = Matter;

        // Create engine
        const engine = Engine.create();
        const world = engine.world;
        
        // Set initial gravity
        engine.world.gravity.y = 1;

        // Create renderer
        const render = Render.create({
            element: document.body,
            engine: engine,
            options: {
                width: window.innerWidth,
                height: window.innerHeight,
                wireframes: false,
                background: 'transparent'
            }
        });

        Render.run(render);
        const runner = Runner.create();
        Runner.run(runner, engine);

        // Ball properties
        const balls = [];
        const ballColors = ['#FF6B6B', '#4ECDC4', '#FFE66D', '#6B5B95', '#88D8B0', '#FF9F68', '#AEC6CF', '#FFB6C1'];
        let currentColorIndex = 0;
        let gravityMode = 'normal';
        
        // Create ball with random color and properties
        function createBall(x, y, radius = 20) {
            const color = ballColors[Math.floor(Math.random() * ballColors.length)];
            const ball = Bodies.circle(x, y, radius, {
                restitution: 0.8,
                friction: 0.2,
                render: {
                    fillStyle: color,
                    strokeStyle: '#333',
                    lineWidth: 1
                }
            });
            
            // Store color with ball for later reference
            ball.color = color;
            balls.push(ball);
            World.add(world, ball);
            
            // Update ball counter
            updateBallCounter();
            
            return ball;
        }

        // Add initial balls
        function addBalls(count = 50) {
            for (let i = 0; i < count; i++) {
                const xPos = Math.random() * window.innerWidth;
                createBall(xPos, -20, 20);
            }
        }

        // Clear all balls
        function clearBalls() {
            balls.forEach(ball => {
                World.remove(world, ball);
            });
            balls.length = 0;
            updateBallCounter();
        }

        // Change ball colors
        function changeColors() {
            currentColorIndex = (currentColorIndex + 1) % ballColors.length;
            
            balls.forEach(ball => {
                const newColor = ballColors[(ballColors.indexOf(ball.color) + 1) % ballColors.length];
                ball.render.fillStyle = newColor;
                ball.color = newColor;
            });
        }

        // Toggle gravity mode
        function toggleGravity() {
            if (gravityMode === 'normal') {
                engine.world.gravity.y = 0.1; // Much lower gravity
                gravityMode = 'low';
                document.getElementById('toggleGravity').textContent = 'Low Gravity';
            } else if (gravityMode === 'low') {
                engine.world.gravity.y = 2;
                gravityMode = 'high';
                document.getElementById('toggleGravity').textContent = 'High Gravity';
            } else {
                engine.world.gravity.y = 1;
                gravityMode = 'normal';
                document.getElementById('toggleGravity').textContent = 'Normal Gravity';
            }
        }

        // Update ball counter display
        function updateBallCounter() {
            document.getElementById('ball-counter').textContent = `Balls: ${balls.length}`;
        }

        // Create initial balls
        addBalls(50);

        // Create boundaries
        const boundaryOptions = { 
            isStatic: true, 
            render: { 
                fillStyle: '#2E4A76',
                strokeStyle: '#1A365D',
                lineWidth: 2
            } 
        };
        
        const ground = Bodies.rectangle(
            window.innerWidth / 2, 
            window.innerHeight, 
            window.innerWidth, 
            20, 
            boundaryOptions
        );
        
        const leftWall = Bodies.rectangle(
            0, 
            window.innerHeight / 2, 
            20, 
            window.innerHeight, 
            boundaryOptions
        );
        
        const rightWall = Bodies.rectangle(
            window.innerWidth, 
            window.innerHeight / 2, 
            20, 
            window.innerHeight, 
            boundaryOptions
        );
        
        World.add(world, [ground, leftWall, rightWall]);

        // Mouse interaction
        const mouse = Mouse.create(render.canvas);
        const mouseConstraint = MouseConstraint.create(engine, {
            mouse: mouse,
            constraint: {
                stiffness: 0.2,
                render: { 
                    visible: false 
                }
            }
        });
        World.add(world, mouseConstraint);

        // Mouse proximity effect
        render.canvas.addEventListener('mousemove', (event) => {
            balls.forEach(ball => {
                const dx = ball.position.x - event.clientX;
                const dy = ball.position.y - event.clientY;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 50) {
                    Matter.Body.applyForce(ball, ball.position, {
                        x: dx * 0.001,
                        y: dy * 0.001
                    });
                    
                    // Create visual effect
                    if (Math.random() > 0.7) {
                        createParticle(event.clientX, event.clientY, ball.color);
                    }
                }
            });
        });

        // Create visual particles
        function createParticle(x, y, color) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.backgroundColor = color;
            particle.style.left = `${x}px`;
            particle.style.top = `${y}px`;
            document.body.appendChild(particle);
            
            // Animate particle
            const angle = Math.random() * Math.PI * 2;
            const speed = 2 + Math.random() * 3;
            const vx = Math.cos(angle) * speed;
            const vy = Math.sin(angle) * speed;
            
            let opacity = 0.7;
            const animate = () => {
                opacity -= 0.02;
                particle.style.opacity = opacity;
                particle.style.left = `${parseFloat(particle.style.left) + vx}px`;
                particle.style.top = `${parseFloat(particle.style.top) + vy}px`;
                
                if (opacity > 0) {
                    requestAnimationFrame(animate);
                } else {
                    document.body.removeChild(particle);
                }
            };
            
            animate();
        }

        // Button event listeners
        document.getElementById('addBalls').addEventListener('click', () => addBalls(50));
        document.getElementById('clearBalls').addEventListener('click', clearBalls);
        document.getElementById('changeColors').addEventListener('click', changeColors);
        document.getElementById('toggleGravity').addEventListener('click', toggleGravity);

        // Handle window resize
        window.addEventListener('resize', () => {
            render.canvas.width = window.innerWidth;
            render.canvas.height = window.innerHeight;
            
            // Update boundaries
            Matter.Body.setPosition(ground, { 
                x: window.innerWidth / 2, 
                y: window.innerHeight 
            });
            Matter.Body.setPosition(leftWall, { 
                x: 0, 
                y: window.innerHeight / 2 
            });
            Matter.Body.setPosition(rightWall, { 
                x: window.innerWidth, 
                y: window.innerHeight / 2 
            });
        });
    </script>
</body>
</html>